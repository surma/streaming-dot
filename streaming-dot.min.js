(function(a,b){'object'==typeof exports&&'string'!=typeof exports.nodeName?b(exports,require('events')):b(a.doT={})})(this,function(a,b){'use strict';function d(g){return g.replace(/\\('|\\)/g,'$1').replace(/[\r\t\n]/g,' ')}Object.assign(a,{version:'1.0.0',templateSettings:{evaluate:/\{\{(([^\}]+|\\.)+)\}\}/g,interpolate:/\{\{=([^\}]+)\}\}/g,stream:/\{\{~([^\}]+)\}\}/g,conditional:/\{\{\?\s*([^\}]*)\}\}/g,node:'object'==typeof process,varname:'it'}}),a.compile=function(g,h){h=Object.assign({},a.templateSettings,h);var i=`
    var s = (r) => {
      r = r.getReader();
      var done = false;
      return {
        next: _ => ({done, value: r.read().then(v => {done = v.done; return P(v.value)})}),
        [Symbol.iterator]: function(){return this}
      };
    };
    `;g='var P=Promise.resolve.bind(Promise);'+i+'var g=function* () {yield P(\''+g.replace(/'|\\/g,'\\$&').replace(h.interpolate,function(j,k){return'\');yield P('+d(k)+');yield P(\''}).replace(h.conditional,function(j,k){return k?'\');yield P('+d(k)+').then(v=>v&&P(\'':'\'));yield P(\''}).replace(h.stream,function(j,k){return'\');yield* s('+d(k)+');yield P(\''}).replace(h.evaluate,function(j,k){return'\');'+d(k)+';yield P(\''}).replace(/\n/g,'\\n').replace(/\t/g,'\\t').replace(/\r/g,'\\r')+'\');}();',g+=h.node?`var e = new EE();
        var p = P();
        for(let v of g) {
          p = p.then(_ => v).then(v => v && e.emit('data', v));
        }
        p.then(_ => e.emit('end'));
        return e`:`var e=new TextEncoder();return new ReadableStream({
          pull: ctr => {
            var v = g.next();
            if (v.done) return ctr.close();
            v.value.then(data => {
              if (typeof(data) === "string") data = e.encode(data);
              data && ctr.enqueue(data);
            });
            return v.value;
          }
        });`;try{if(h.noEval)return g;if(h.node){// EE is EventEmitter
const j=new Function(h.varname,'EE',g);return k=>j(k,b)}return new Function(h.varname,g)}catch(j){throw console.log('Could not create a template function: '+g),j}}});
